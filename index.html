<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Habit Yearly Heatmap Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .container {
            max-width: 1000px;
            margin-top: 20px;
        }
        .header {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        .heatmap {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(20px, 1fr));
            gap: 2px;
        }
        .week {
            display: grid;
            grid-template-rows: repeat(7, 20px); /* 7 days for each week */
            gap: 2px;
        }
        .day {
            width: 20px;
            height: 20px;
            border: 1px solid #ddd;
            background-color: #f8f9fa;
        }
        .completed {
            background-color: #198754; /* Bootstrap success color */
        }
    </style>
</head>
<body>
<div id="app" class="container">
    <div class="header">{{ currentYear }}</div>

    <div class="heatmap">
        <!-- Create a week block for each week of the year -->
        <div v-for="week in numberOfWeeks" :key="week" class="week">
            <!-- Create a day block for each day of the week -->
            <div v-for="dayOfWeek in 7" :key="dayOfWeek" class="day"
                :class="{ 'completed': isHabitOnDay(week, dayOfWeek) }"
                @click="toggleHabitDay(week, dayOfWeek)">
            </div>
        </div>
    </div>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        currentYear: new Date().getFullYear(),
        habits: JSON.parse(localStorage.getItem('habits')) || [],
        days: this.initializeDays()
    },
    computed: {
        numberOfWeeks() {
            // Calculate the number of weeks in the current year
            const startOfWeek = new Date(this.currentYear, 0, 1);
            const endOfWeek = new Date(this.currentYear, 11, 31);
            return Math.ceil((endOfWeek - startOfWeek) / (7 * 24 * 60 * 60 * 1000)) + 1;
        }
    },
    methods: {
        initializeDays() {
            let days = [];
            // Initialize the days array with false to indicate no habit was performed
            for (let week = 0; week < this.numberOfWeeks; week++) {
                let weekDays = [];
                for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
                    weekDays.push(false);
                }
                days.push(weekDays);
            }
            return days;
        },
        isHabitOnDay(week, dayOfWeek) {
            // Check if a habit was performed on this day of the week in this week of the year
            const date = new Date(this.currentYear, 0, (week - 1) * 7 + dayOfWeek);
            const dateString = date.toISOString().split('T')[0];
            return this.habits.some(habit => habit.dates.includes(dateString));
        },
        toggleHabitDay(week, dayOfWeek) {
            const date = new Date(this.currentYear, 0, (week - 1) * 7 + dayOfWeek);
            const dateString = date.toISOString().split('T')[0];
            this.habits.forEach(habit => {
                const index = habit.dates.indexOf(dateString);
                if (index === -1) {
                    habit.dates.push(dateString);
                } else {
                    habit.dates.splice(index, 1);
                }
            });
            this.saveHabits();
        },
        saveHabits() {
            localStorage.setItem('habits', JSON.stringify(this.habits));
        }
    },
    mounted() {
        // Populate with example data on first run
        if (!this.habits.length) {
            this.habits.push({id: 1, name: 'Exercise', dates: []});
            // Repeat for more habits as needed
        }
    }
});
</script>
</body>
</html>
