<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yearly Habit Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <style>
        .heatmap {
            display: flex;
            flex-wrap: wrap;
            max-width: 140px; /* Adjust based on day cell width */
        }
        .day {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: #f8f9fa; /* Light grey for non-completed days */
            border: 1px solid #ccc;
        }
        .completed {
            background-color: #4CAF50; /* Green for completed days */
        }
    </style>
</head>
<body>
<div id="app">
    <div v-for="week in calculateWeeksOfYear(currentYear)" :key="week[0]">
        <div v-for="date in week" :key="date" class="day" 
            :class="{'completed': habits.includes(date.toISOString().slice(0, 10))}"
            @click="toggleHabit(date.toISOString().slice(0, 10))">
            {{ date.getDate() }}
        </div>
    </div>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        currentYear: new Date().getFullYear(),
        habits: JSON.parse(localStorage.getItem('habits') || '[]')
    },
    methods: {
        calculateWeeksOfYear(year) {
            const startDate = new Date(year, 0, 1);
            const endDate = new Date(year, 11, 31);
            let currentWeek = [];
            let weeks = [];

            // Adjust the start date to the first Sunday of the year
            while (startDate.getDay() !== 0) {
                startDate.setDate(startDate.getDate() + 1);
            }

            while (startDate <= endDate) {
                currentWeek.push(new Date(startDate));
                startDate.setDate(startDate.getDate() + 1);
                if (currentWeek.length === 7) {
                    weeks.push([...currentWeek]);
                    currentWeek = [];
                }
            }

            // Handle the last week which might be less than 7 days
            if (currentWeek.length > 0) {
                weeks.push([...currentWeek]);
            }

            return weeks;
        },
        toggleHabit(dateString) {
            const index = this.habits.indexOf(dateString);
            if (index === -1) {
                this.habits.push(dateString);
            } else {
                this.habits.splice(index, 1);
            }
            localStorage.setItem('habits', JSON.stringify(this.habits));
        }
    }
});
</script>
</body>
</html>
