<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Yearly Habit Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
<style>
    .heatmap {
        display: grid;
        grid-template-columns: repeat(53, 25px); /* Max 53 weeks in a year */
        grid-auto-rows: 25px; /* Height of each day block */
        gap: 2px; /* Space between blocks */
    }
    .day {
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #f8f9fa; /* Light grey for non-completed days */
        border: 1px solid #ccc;
    }
    .completed {
        background-color: #4CAF50; /* Green for completed days */
    }
</style>
</head>
<body>
<div id="app">
    <div class="heatmap">
        <!-- Generate days for the heatmap -->
        <div v-for="week in calculateWeeksOfYear(currentYear)" :key="week.start.getTime()" class="week">
            <div v-for="day in week" :key="day" class="day" 
                :class="{'completed': habits.includes(day.toISOString().slice(0, 10))}"
                @click="toggleHabit(day.toISOString().slice(0, 10))">
                {{ day.getDate() }}
            </div>
        </div>
    </div>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        currentYear: new Date().getFullYear(),
        habits: JSON.parse(localStorage.getItem('habits') || '[]')
    },
    methods: {
        calculateWeeksOfYear(year) {
            const startDate = new Date(year, 0, 1);
            const endDate = new Date(year, 11, 31);
            const weeks = [];
            let currentWeek = [];

            while (startDate.getDay() !== 0) {
                startDate.setDate(startDate.getDate() + 1); // Move to first Sunday of the year
            }

            while (startDate <= endDate) {
                currentWeek.push(new Date(startDate));
                startDate.setDate(startDate.getDate() + 1);
                if (currentWeek.length === 7 || startDate > endDate) {
                    weeks.push(currentWeek);
                    currentWeek = [];
                }
            }

            return weeks;
        },
        toggleHabit(dateString) {
            const index = this.habits.indexOf(dateString);
            if (index === -1) {
                this.habits.push(dateString);
            } else {
                this.habits.splice(index, 1);
            }
            localStorage.setItem('habits', JSON.stringify(this.habits));
        }
    }
});
</script>
</body>
</html>
